(this.webpackJsonpmastkloot=this.webpackJsonpmastkloot||[]).push([[0],{126:function(e,t,n){e.exports=n(162)},127:function(e,t,n){},128:function(e,t,n){},162:function(e,t,n){"use strict";n.r(t);n(127),n(128);var a=n(0),r=n.n(a),o=n(12),c=n.n(o),i=n(3),u=n(18),l=n(16),s=Object(l.b)({name:"global",initialState:{activity:{type:"components"}},reducers:{setActivity:function(e,t){var n=t.payload;e.activity=n}}}),d=function(e){return e.global.activity},p=n(20),m=n(15),f=Symbol();function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(t(e,n)!==f&&("component"===e.type||"tag"===e.type))for(var a in e.slots)for(var r=e.slots[a],o=r.length,c=0;c<o;++c)v(r[c],t,[].concat(Object(p.a)(n),[[a,c]]))}function h(e,t){var n=[];return v(e,(function(e,a){t(e,a)&&n.push(e)})),n}function b(e,t){for(var n=0;n<t.length;++n){var a=t[n];e=e.slots[a[0]][a[1]]}return e}function g(e){return function(e,t){var n=[];return v(e,(function(e,a){return n.push(t(e,a))})),n}(e,(function(e){return e.id}))}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id",n=Object(m.max)(e.map((function(e){return parseInt(e.replace(t,""))})))||0;return"".concat(t).concat(n+1)}function E(e,t,n){return{id:e,type:"shadow",width:t,height:n}}function j(e,t,n){return[E(e,t,n)]}function O(e,t){var n=y(e);return{id:n,type:"tag",tag:t,style:{},slots:{children:j(y([].concat(Object(p.a)(e),[n])),"100%","50px")}}}function x(e,t){var n=h(t.template,(function(e){return"slot"===e.type})),a=y(e),r=n.reduce((function(t,n){var r=y([a].concat(Object(p.a)(e),Object(p.a)(t)));return[].concat(Object(p.a)(t),[r])}),[]),o=n.map((function(e,t){return[e.code,j(r[t],e.width,e.height)]})),c=Object.fromEntries(o);return{id:a,type:"component",component:t.id,props:{},slots:c}}var C=n(7),k=n(19),w=n(21),_=n(23),N=m.isEqual;function P(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function S(e,t){return function(e,t,n){if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a)if(!n(e[a],t[a]))return!1;return!0}(e,t,P)}function M(e){var t=e.length-1;return[e.slice(0,t),e[t]]}var A=function(){function e(){Object(w.a)(this,e),this.map=new Map}return Object(_.a)(e,[{key:"get",value:function(e){return this.map.get(e)}},{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"clear",value:function(){this.map.clear()}},{key:"delete",value:function(e){return this.map.delete(e)}}]),e}();function B(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function F(e){return Object(k.a)({documentId:{type:"page",id:""},activeNodePath:void 0,activeShadowContent:void 0,hoverNode:void 0,blinkAreas:[],mainCoords:{left:0,top:0,right:0,bottom:0,width:0,height:0},iframeCoords:{left:0,top:0,right:0,bottom:0,width:0,height:0},contextMenu:void 0,refs:new A,coords:{}},e)}var I=Object(l.b)({name:"vars",initialState:F(),reducers:{merge:function(e,t){var n=t.payload;Object.assign(e,n)},setIframeCoords:function(e,t){var n=t.payload;e.iframeCoords=n},setMainCoords:function(e,t){var n=t.payload;e.mainCoords=n},setActiveShadowContent:function(e,t){var n=t.payload;e.activeShadowContent=n},setActiveNode:function(e,t){var n=t.payload;e.activeNodePath=n},setHoverNode:function(e,t){var n=t.payload;e.hoverNode=n},setContextMenu:function(e,t){var n=t.payload;e.contextMenu=n},addBlinkArea:function(e,t){var n=Object(C.a)(t.payload,2),a=n[0];n[1];e.blinkAreas=[{uid:a}]},removeBlinkArea:function(e,t){var n=t.payload,a=e.blinkAreas.findIndex((function(e){return e.uid===n}));a>-1&&e.blinkAreas.splice(a,1)},removeAllBlinkAreas:function(e){e.blinkAreas=[]},setCoords:function(e,t){var n=Object(C.a)(t.payload,2),a=n[0],r=n[1];e.coords[a]=r},removeCoords:function(e,t){var n=t.payload;delete e.coords[n]}}}),R=Object(l.b)({name:"template",initialState:{id:"0",name:"page",template:{id:"0",type:"tag",tag:"div",style:{},slots:{children:[]}}},reducers:{replaceDocument:function(e,t){return t.payload},replaceNode:function(e,t){var n=e.template,a=Object(C.a)(t.payload,2),r=a[0],o=a[1],c=M(r),i=Object(C.a)(c,2),u=i[0],l=Object(C.a)(i[1],2),s=l[0],d=l[1];b(n,u).slots[s][d]=o},insertNode:function(e,t){var n=e.template,a=Object(C.a)(t.payload,3),r=a[0],o=a[1],c=a[2],i=M(r),u=Object(C.a)(i,2),l=u[0],s=Object(C.a)(u[1],2),d=s[0],p=s[1];b(n,l).slots[d].splice(p+c,0,o)},removeNode:function(e,t){var n=e.template,a=M(t.payload),r=Object(C.a)(a,2),o=r[0],c=Object(C.a)(r[1],2),i=c[0],u=c[1];b(n,o).slots[i].splice(u,1)},setStyleProp:function(e,t){var n=e.template,a=Object(C.a)(t.payload,3),r=a[0],o=a[1],c=a[2];b(n,r).style[o]=c},setSlotParams:function(e,t){var n=e.template,a=Object(C.a)(t.payload,3),r=a[0],o=a[1],c=a[2];b(n,r)[o]=c},setText:function(e,t){var n=e.template,a=Object(C.a)(t.payload,2),r=a[0],o=a[1];b(n,r).text=o},addComponentProp:function(e,t){var n=t.payload;e.props.push(Object(k.a)({id:y(e.props.map((function(e){return e.id})),"prop"),type:"style"},n))},setComponentProp:function(e,t){var n=e.template,a=Object(C.a)(t.payload,3),r=a[0],o=a[1],c=a[2];b(n,r).props[o]=c}}}),D=Object(u.c)({document:R.reducer,vars:I.reducer}),L=function(e){return e.editor.document.template},T=function(e){var t=e.editor.vars.activeNodePath;if(t)return{path:t,node:b(e.editor.document.template,t)}},H=function(e){return e.editor.vars.mainCoords},W=function(e){return e.editor.vars.iframeCoords},K=function(e){return e.editor.vars.blinkAreas},U=function(e){return e.editor.vars.contextMenu},z=function(e){return e.editor.vars.refs},V=function(e){return e.editor.vars.activeShadowContent};var G=Object(l.b)({name:"components",initialState:{components:[]},reducers:{setComponents:function(e,t){var n=t.payload;e.components=n}}}),Y=Object(l.b)({name:"pages",initialState:{pages:[]},reducers:{setPages:function(e,t){var n=t.payload;e.pages=n}}}),X=Object(l.c)({serializableCheck:!1}),J=Object(l.a)({reducer:Object(u.c)({global:s.reducer,editor:D,pages:Y.reducer,components:G.reducer}),middleware:X}),Q=n(75),q=n.n(Q),Z=n(165),$=n(17),ee=n.n($),te=n(28),ne=n(25),ae=n(24),re=n(76),oe=10,ce=[{id:"index",name:"index",template:{id:"id".concat(oe++),type:"tag",tag:"div",style:{padding:"5%",backgroundColor:"#0FFFF0"},slots:{children:[{id:"id".concat(oe++),type:"shadow",width:"100%",height:"350px"}]}}},{id:"about",name:"about",template:{id:"id".concat(oe++),type:"tag",tag:"div",style:{padding:"5%",backgroundColor:"#0FFFF0"},slots:{children:[{id:"id".concat(oe++),type:"shadow",width:"100%",height:"350px"}]}}}],ie=0,ue=[{id:"foo",name:"foo",place:{width:"500px"},template:{id:"id".concat(ie++),type:"tag",tag:"div",style:{display:"flex"},slots:{children:[{id:"id".concat(ie++),type:"tag",tag:"div",style:{},slots:{children:[{id:"id".concat(ie++),type:"text",text:"hhh"}]}},{id:"id".concat(ie++),type:"tag",tag:"div",style:{minWidth:"300px"},slots:{children:[{id:"id".concat(ie++),type:"slot",code:"a-slot",width:"100%",height:"100px"}]}}]}},props:[]},{id:"bar",name:"bar",place:{width:"500px"},template:{id:"id".concat(ie++),type:"tag",tag:"div",style:{display:"flex",borderWidth:"1px",borderStyle:"dotted",borderColor:"black"},slots:{children:[{id:"id".concat(ie++),type:"tag",tag:"div",style:{minWidth:"350px"},slots:{children:[{id:"id".concat(ie++),type:"slot",code:"b-slot",width:"100%",height:"100px"}]}},{id:"id".concat(ie++),type:"tag",tag:"div",style:{},slots:{children:[{id:"id".concat(ie++),type:"text",text:"sss efhd ert rete a"}]}}]}},props:[]},{id:"tree",name:"qwe",place:{width:"500px"},template:{id:"id".concat(ie++),type:"tag",tag:"div",style:{padding:"15px",backgroundColor:"#ff0000"},slots:{children:[{id:"id".concat(ie++),type:"text",text:"hoba"}]}},props:[]}],le=new(function(e){Object(ne.a)(n,e);var t=Object(ae.a)(n);function n(){var e;return Object(w.a)(this,n),(e=t.call(this,"DataStore")).pages=void 0,e.components=void 0,e.version(1).stores({pages:"&id,name,template",components:"&id,name,template,props"}),e.on("populate",(function(){ce.forEach((function(t){return e.pages.add(t)})),ue.forEach((function(t){return e.components.add(t)}))})),e.pages=e.table("pages"),e.components=e.table("components"),e}return n}(re.a));function se(e){return de.apply(this,arguments)}function de(){return(de=Object(te.a)(ee.a.mark((function e(t){var n,a;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("page"!==t.type){e.next=7;break}return e.next=3,le.pages.get(t.id);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.next=9,le.components.get(t.id);case 9:return a=e.sent,e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e,t){return function(n,a){Object(i.b)((function(){n(R.actions.replaceDocument(e)),n(I.actions.merge(t))}))}}var me=s.actions.setActivity;function fe(e){return function(){var t=Object(te.a)(ee.a.mark((function t(n,a){var r,o,c,u,l;return ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a(),o=r.global.activity,d=o,!("editor"===(s=e).type&&"editor"===d.type?N(s.document,d.document):N(s,d))){t.next=3;break}return t.abrupt("return");case 3:if(c=[],"editor"===o.type&&n(function(){var e=Object(te.a)(ee.a.mark((function e(t,n){var a,r,o;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n().editor,r=a.vars,o=a.document,r.initialDocument===o){e.next=10;break}if("page"!==r.documentId.type){e.next=6;break}return e.next=5,le.pages.update(r.documentId.id,Object(m.omit)(o,"id"));case 5:t(ve());case 6:if("component"!==r.documentId.type){e.next=10;break}return e.next=9,le.components.update(r.documentId.id,Object(m.omit)(o,"id"));case 9:t(he());case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),"editor"!==e.type){t.next=12;break}return t.next=8,se(e.document);case 8:u=t.sent,l=F({documentId:e.document,initialDocument:u}),c.push(pe(u,l)),c.push((function(e,t){var n=t(),a=n.editor.document,r=n.components.components,o=[];v(a.template,(function(e,t){if("component"===e.type){var n=r.find((function(t){return t.id===e.component})),a=h(n.template,(function(e){return"slot"===e.type}));console.log(a)}})),Object(i.b)((function(){return o.forEach(e)}))}));case 12:c.push(me(e)),Object(i.b)((function(){return c.forEach(n)}));case 14:case"end":return t.stop()}var s,d}),t)})));return function(e,n){return t.apply(this,arguments)}}()}function ve(){return function(){var e=Object(te.a)(ee.a.mark((function e(t,n){var a;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.pages.toArray();case 2:a=e.sent,t(Y.actions.setPages(a));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}function he(){return function(){var e=Object(te.a)(ee.a.mark((function e(t,n){var a;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.components.toArray();case 2:a=e.sent,t(G.actions.setComponents(a));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}var be=n(34),ge=n.n(be),ye=n(4),Ee=n.n(ye),je=n(77),Oe=n.n(je),xe=n(78),Ce=n.n(xe),ke=n(166),we=n(79),_e=n.n(we);function Ne(e){var t=e.children;return r.a.createElement("div",{className:_e.a.allProps},t)}var Pe=Object(m.keyBy)([{name:"color",type:"color",defaults:function(){return"#000000"}},{name:"backgroundColor",type:"color",defaults:function(){return"#FFFFFF"}},{name:"borderColor",type:"color",defaults:function(){return"#000000"}},{name:"borderStyle",type:"variant",variants:["solid","dotted","double"],defaults:function(){return"solid"}},{name:"borderRadius",type:"length-percentage",defaults:function(){return"1px"}},{name:"borderWidth",type:"length",defaults:function(){return"1px"}},{name:"width",type:"length-percentage",defaults:function(){return"100%"}},{name:"height",type:"length-percentage",defaults:function(){return"100px"}},{name:"minWidth",type:"length-percentage",defaults:function(){return"100%"}},{name:"minHeight",type:"length-percentage",defaults:function(){return"100px"}},{name:"padding",type:"length-percentage",defaults:function(){return"0px"}},{name:"margin",type:"length-percentage",defaults:function(){return"0px"}},{name:"display",type:"variant",variants:["block","flex"],defaults:function(){return"block"}},{name:"justifyContent",type:"variant",variants:["normal","center","start","end","space-between","space-around"],defaults:function(){return"center"}}],"name"),Se=Object(m.sortBy)(Object.keys(Pe));Se.length;function Me(e){var t=e.title,n=e.onSubmit,o=Object(a.useState)(""),c=Object(C.a)(o,2),i=c[0],u=c[1];return r.a.createElement(Z.g,null,r.a.createElement(Z.i,{placeholder:t,autoFocus:!0,value:i,onChange:function(e){return u(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&n(i)}}),r.a.createElement(Z.c,{icon:"arrow-right",onClick:function(){return n(i)}}))}function Ae(e){var t=e.title,n=e.onSubmit,a=e.children;return r.a.createElement(Z.n,{content:r.a.createElement(Z.e,null,r.a.createElement(Me,{title:t,onSubmit:n}))},a)}var Be=n(45),Fe=n.n(Be);var Ie=n(83),Re=n.n(Ie),De=n(13),Le=["px"];function Te(e){var t=e.value,n=e.onChange,a=e.units,o=t.match(/^-?\d+/)[0],c=t.substring(o.length),i=r.a.createElement(Z.n,{content:r.a.createElement(Z.j,{className:Re.a.menu},a.map((function(e){return r.a.createElement(Z.k,{text:e,key:e,active:e===c,onClick:function(){return n("".concat(o).concat(e))}})}))),position:De.a.BOTTOM_RIGHT},r.a.createElement(Z.c,{minimal:!0,rightIcon:"caret-down"},c));return r.a.createElement(Z.m,{value:o,onValueChange:function(e){return n("".concat(e).concat(c))},rightElement:i})}var He=["px","%"];var We=ke.a.ofType(),Ke=function(e,t){var n=t.handleClick,a=t.modifiers;return r.a.createElement(Z.k,{active:a.active,disabled:a.disabled,key:e,onClick:n,text:e})};var Ue={color:function(e){var t=e.value,n=e.onChange;return r.a.createElement("input",{type:"color",value:t,onChange:function(e){return n(e.target.value)}})},length:function(e){var t=e.value,n=e.onChange;return r.a.createElement(Te,{value:t,onChange:n,units:Le})},"length-percentage":function(e){var t=e.value,n=e.onChange;return r.a.createElement(Te,{value:t,onChange:n,units:He})},variant:function(e){var t=e.value,n=e.onChange,a=e.type;return r.a.createElement(We,{activeItem:t,items:a.variants,itemRenderer:Ke,onItemSelect:n,filterable:!1},r.a.createElement(Z.c,{text:t,rightIcon:"caret-down"}))}};function ze(e){var t=e.propName,n=e.label,a=e.value,o=e.onChange,c=e.menuContent,i=Pe[t];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Fe.a.cell},n),r.a.createElement("div",{className:Fe.a.cell},r.a.createElement(Ue[i.type],{value:a,onChange:o,type:i})),r.a.createElement("div",{className:Fe.a.cell},c&&r.a.createElement(c,{propName:t})))}var Ve=function(e,t){var n=t.handleClick,a=t.modifiers;return r.a.createElement(Z.k,{active:a.active,disabled:a.disabled,key:e,onClick:n,text:e})},Ge=function(e,t){return!(e.length>0)||t.startsWith(e)},Ye=ke.a.ofType();function Xe(e){var t=e.node,n=e.path,o=Object(i.d)(),c=Object(a.useMemo)((function(){return Object(m.sortBy)(Object.keys(t.style))}),[t.style]),u=Object(a.useMemo)((function(){return Object(m.difference)(Se,c)}),[c]),l=Object(i.e)((function(e){return["component"===e.editor.vars.documentId.type,e.editor.document.props]}),P),s=Object(a.useMemo)((function(){var e=Object(C.a)(l,2),t=e[0],a=e[1];if(t)return function(e){var t=e.propName;return a.some((function(e){return S(e.path,n)&&e.prop===t}))?null:r.a.createElement(Ae,{title:"component prop name",onSubmit:function(e){return o(R.actions.addComponentProp({path:n,prop:t,name:e}))}},r.a.createElement(Z.c,{icon:"menu"}))}}),[l,n,o]);return r.a.createElement(Z.e,null,r.a.createElement(Ne,null,c.map((function(e){return r.a.createElement(ze,{propName:e,label:e,value:t.style[e],onChange:function(t){return o(R.actions.setStyleProp([n,e,t]))},menuContent:s,key:e})}))),u.length>0&&r.a.createElement("div",{className:Ce.a.propSelect},r.a.createElement(Ye,{activeItem:null,items:u,itemRenderer:Ve,itemPredicate:Ge,onItemSelect:function(e){var t=Pe[e].defaults();o(R.actions.setStyleProp([n,e,t]))}},r.a.createElement(Z.c,{text:"Add new prop",rightIcon:"caret-down"}))))}function Je(e){var t=e.node,n=e.path,a=Object(i.d)(),o=Object(i.e)((function(e){return e.components.components.find((function(e){return e.id===t.component}))}));return r.a.createElement(Z.e,null,r.a.createElement(Ne,null,o.props.map((function(e){return r.a.createElement(ze,{propName:e.prop,label:e.name,value:t.props[e.id],onChange:function(t){return a(R.actions.setComponentProp([n,e.id,t]))},key:e.id})}))))}var Qe=["width","height"];function qe(e){var t=e.node,n=e.path,a=Object(i.d)();return r.a.createElement(Z.e,null,r.a.createElement(Ne,null,Qe.map((function(e){return r.a.createElement(ze,{propName:e,label:e,value:t[e],onChange:function(t){return a(R.actions.setSlotParams([n,e,t]))},key:e})}))))}function Ze(){var e,t=Object(i.e)(T,i.c),n=Object(i.e)(L);if(t){var a=t.node,o=t.path;switch(a.type){case"shadow":e=r.a.createElement("div",null,"shadow");break;case"slot":e=r.a.createElement(qe,{node:a,path:o});break;case"text":e=r.a.createElement("div",null,"text &",a.text,"&");break;case"tag":e=r.a.createElement(Xe,{node:a,path:o});break;case"component":e=r.a.createElement(Je,{node:a,path:o});break;default:e=r.a.createElement("div",null,"Select something")}}return r.a.createElement("div",{className:Oe.a.rightSpace},e,r.a.createElement("div",{style:{height:300}},r.a.createElement("pre",null,JSON.stringify(n,null,2))))}function $e(e,t){return".".concat(e," {").concat(Object(m.map)(t,(function(e,t){return"".concat(Object(m.kebabCase)(t),": ").concat(e,";")})).join("\n"),"}")}function et(){for(var e=[],t=document.styleSheets,n=0;n<t.length;++n)for(var a=t[n],r=0;r<a.cssRules.length;++r){var o=a.cssRules[r];o instanceof CSSStyleRule&&o.selectorText.startsWith("._frame")&&e.push(o.cssText),o instanceof CSSKeyframesRule&&o.name.startsWith("_frame")&&e.push(o.cssText)}return[{id:"parent",style:e.join("\n")}]}var tt=r.a.memo((function(e){var t=e.styles;return r.a.createElement(r.a.Fragment,null,t.map((function(e){return r.a.createElement("style",{type:"text/css",key:e.id},e.style)})))})),nt=r.a.memo((function(e){var t=[];v(e.tree,(function(n,a){if(function(e){return"tag"===e.type&&Object.keys(e.style).length>0}(n)){var r=Object(m.mapValues)(n.style,(function(t,n){var r=e.adds.find((function(e){return e.prop===n&&S(a,e.path)}));return r?"var(--".concat(e.prefix).concat(r.id,", ").concat(t,")"):t}));t.push([n.id,r])}}));var n=t.map((function(t){return{id:t[0],style:$e("".concat(e.prefix).concat(t[0]),t[1])}}));return r.a.createElement(tt,{styles:n})})),at=function(e){return e.components.components},rt=r.a.memo((function(){var e=Object(i.e)(at);return r.a.createElement(r.a.Fragment,null,e.map((function(e){return r.a.createElement(nt,{tree:e.template,prefix:"c".concat(e.id,"_"),adds:e.props.filter((function(e){return"style"===e.type})),key:e.id})})))})),ot=[],ct=function(e){var t=e.tree,n=Object(a.useMemo)(et,[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(tt,{styles:n}),r.a.createElement(nt,{tree:t,prefix:"t",adds:ot}),r.a.createElement(rt,null))},it=n(43);function ut(e){var t=function e(t){var n=t.parentNode;return function(e){var t,n=null===e||void 0===e||null===(t=e.defaultView)||void 0===t?void 0:t.HTMLDocument;return!!n&&e instanceof n}(n)?n:e(n)}(e),n=t.createTextNode("");e.appendChild(n);var a=t.activeElement===e;if(null!==n&&null!==n.nodeValue&&a){var r,o=null===(r=t.defaultView)||void 0===r?void 0:r.getSelection();if(o){var c=t.createRange();c.setStart(n,n.nodeValue.length),c.collapse(!0),o.removeAllRanges(),o.addRange(c)}e instanceof HTMLElement&&e.focus()}}var lt=function(e){Object(ne.a)(n,e);var t=Object(ae.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).lastHtml=e.props.html,e.getEl=function(){return e.props.attrs.ref.current},e.emitChange=function(t){var n=e.getEl();if(n){var a=n.innerHTML;e.props.onChange&&a!==e.lastHtml&&e.props.onChange(a),e.lastHtml=a}},e}return Object(_.a)(n,[{key:"render",value:function(){var e=this.props,t=e.attrs,n=e.html,a=Object(it.a)(e,["attrs","html"]);return r.a.createElement("span",Object(k.a)(Object(k.a)({dangerouslySetInnerHTML:{__html:n},onInput:this.emitChange,onBlur:this.props.onBlur||this.emitChange,onKeyUp:this.props.onKeyUp||this.emitChange,onKeyDown:this.props.onKeyDown||this.emitChange,contentEditable:!0},a),t))}},{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=this.getEl();return!n||(e.html!==n.innerHTML||(t.className!==e.className||t.attrs!==e.attrs))}},{key:"componentDidUpdate",value:function(){var e=this.getEl();e&&(this.props.html!==e.innerHTML&&(e.innerHTML=this.props.html),this.lastHtml=this.props.html,ut(e))}}]),n}(r.a.Component);function st(e){return function(t,n){Object(i.b)((function(){var a=b(n().editor.document.template,e);t(I.actions.setActiveNode(e)),"shadow"===a.type&&t(I.actions.setActiveShadowContent())}))}}function dt(){return function(e,t){var n,a=t(),r=a.editor,o=r.vars,c=r.document,u=a.components,l=o.activeNodePath,s=o.activeShadowContent,d=g(c.template);if("slot"===s[0]){var p=y(d);n=function(e){return{id:e,type:"slot",code:"code_".concat(e),width:"100px",height:"100px"}}(p)}if("tag"===s[0]&&(n=O(d,s[1])),"component"===s[0]){var m=u.components.find((function(e){return e.id===s[1]}));n=x(d,m)}Object(i.b)((function(){e(R.actions.replaceNode([l,n])),e(I.actions.setActiveShadowContent())}))}}function pt(e,t){return function(n,a){var r,o=a(),c=o.editor.document,u=o.components,l=M(e),s=Object(C.a)(l,2),d=s[0],p=Object(C.a)(s[1],1)[0],m=b(c.template,d),f=y(g(c.template));if("tag"===m.type&&(r=E(f,"100%","50px")),"component"===m.type){var v=h(u.components.find((function(e){return e.id===m.component})).template,(function(e){return"slot"===e.type&&e.code===p})),j=Object(C.a)(v,1)[0];r=E(f,j.width,j.height)}Object(i.b)((function(){n(I.actions.setActiveNode()),n(R.actions.insertNode([e,r,t]))}))}}function mt(e){return function(t,n){var a=n().editor,r=a.document,o=a.vars.refs,c=b(r.template,e),i=o.get(c.id).getBoundingClientRect();t(I.actions.addBlinkArea([c.id,B(i)])),setTimeout((function(){return t(I.actions.removeBlinkArea(c.id))}),3e3)}}var ft=[],vt=r.a.createContext([{},[],!1,""]),ht=r.a.createContext(!0),bt=r.a.createContext(!1);function gt(e){var t=e.width,n=e.height,o=e.selected,c=e.attrs,i="_frame_slot";return Object(a.useContext)(ht)&&(i+=o?" _frame_slot_waiting":" _frame_slot_active"),r.a.createElement("div",Object.assign({style:{width:t,height:n},className:i},c))}function yt(e){var t=e.name,n=e.attrs,o=Object(a.useMemo)((function(){return O(["-100"],t)}),[t]);return r.a.createElement(ht.Provider,{value:!1},r.a.createElement(Ot,{node:o,path:[["_",0]],classPrefix:"tmp",attrs:n}))}function Et(e){var t=e.componentId,n=e.attrs,o=Object(a.useContext)(ht),c=Object(i.e)((function(e){return e.components.components.find((function(e){return e.id===t}))})),u=Object(a.useMemo)((function(){return x(["-1000"],c)}),[c]);return o?r.a.createElement(ht.Provider,{value:!1},r.a.createElement(xt,{node:u,path:[["_",0]],classPrefix:"x",attrs:n})):null}function jt(e){var t=e.path,n=e.content,o=e.slotName,c=e.classPrefix,i=Object(a.useMemo)((function(){return n.map((function(e,n){return[].concat(Object(p.a)(t),[[o,n]])}))}),[n,t,o]);return r.a.createElement(r.a.Fragment,null,n.map((function(e,t){return r.a.createElement(wt,{key:e.id,node:e,path:i[t],classPrefix:c})})))}function Ot(e){var t=e.node,n=e.path,o=e.classPrefix,c=e.attrs,i=Object(a.useContext)(bt);return r.a.createElement(t.tag,Object(k.a)({className:"".concat(o).concat(t.id)},c),r.a.createElement(bt.Provider,{value:i},r.a.createElement(jt,{path:n,slotName:"children",content:t.slots.children,classPrefix:o})))}function xt(e){var t=e.node,n=e.path,o=e.attrs,c=e.classPrefix,u=Object(i.e)((function(e){return e.components.components.find((function(e){return e.id===t.component}))})),l=Object(a.useContext)(bt),s=Object(a.useMemo)((function(){return[t.slots,n,l,c]}),[t.slots,n,l,c]);return r.a.createElement(vt.Provider,{value:s},r.a.createElement(_t,{node:u.template,active:!1,classPrefix:"c".concat(u.id,"_"),attrs:o,key:"comp_".concat(u.id)}))}function Ct(e){var t=e.node,n=Object(a.useContext)(vt),o=Object(C.a)(n,4),c=o[0],i=o[1],u=o[2],l=o[3],s=t.code,d=c[s];return r.a.createElement(bt.Provider,{value:u},r.a.createElement(jt,{path:i,slotName:s,content:d,classPrefix:l}))}var kt={text:function(e){var t=e.node,n=e.attrs,a=e.path,o=Object(i.d)();return n?r.a.createElement(lt,{attrs:n,html:t.text,onChange:function(e){return o(R.actions.setText([a,e]))}}):r.a.createElement(r.a.Fragment,null,t.text)},tag:Ot,component:xt,slot:function(e){var t=e.node,n=e.attrs,o=Object(a.useContext)(bt);return Object(i.e)((function(e){return"component"===e.editor.vars.documentId.type}))&&o?r.a.createElement("div",Object.assign({className:"_frame_slot_component",style:{width:t.width,height:t.height}},n)):r.a.createElement(Ct,{node:t})},shadow:function(e){var t,n=e.node,a=e.path,o=e.attrs,c=Object(i.e)((function(e){return e.editor.vars})),u=c.activeNodePath,l=c.activeShadowContent,s=!!u&&S(u,a);return l&&s?("slot"===l[0]&&(t=r.a.createElement("div",{className:"_frame_slot_component",style:{width:"100px",height:"100px"}})),"tag"===l[0]&&(t=r.a.createElement(yt,{name:l[1],attrs:o})),"component"===l[0]&&(t=r.a.createElement(Et,{componentId:l[1],attrs:o}))):t=r.a.createElement(gt,{width:n.width,height:n.height,selected:s,attrs:o}),r.a.createElement(bt.Provider,{value:!1},t)}},wt=r.a.memo((function(e){var t=e.node,n=e.path,o=e.classPrefix,c=e.attrs;Object(a.useDebugValue)(t);var u=Object(i.d)(),l=Object(a.useRef)(),s=Object(a.useContext)(bt);!function(e,t,n,r){var o=Object(i.e)(z);Object(a.useLayoutEffect)((function(){if(t){var a=n.current,c=new ResizeObserver((function(){var t=a.getBoundingClientRect();r(I.actions.setCoords([e,B(t)]))}));return c.observe(a),o.set(e,a),function(){c.disconnect(),o.delete(e),r(I.actions.removeCoords(e))}}}),[e,t,n,r,o])}(t.id,s,l,u);var d=Object(a.useMemo)((function(){if(s){var e={ref:l,onClick:function(e){u(function(e,t,n){return function(t,a){e.stopPropagation(),t(st(n))}}(e,0,n))},onContextMenu:function(e){u(function(e,t,n){return function(t,a){e.preventDefault(),e.stopPropagation(),t(I.actions.setContextMenu({path:n,left:e.clientX,top:e.clientY}))}}(e,0,n))},onMouseOver:function(e){u(function(e,t,n){return function(t,a){e.stopPropagation(),Object(i.b)((function(){t(I.actions.setHoverNode(n)),t(mt(n))}))}}(e,0,n))},onMouseOut:function(e){u(function(e,t,n){return function(t,n){e.stopPropagation(),t(I.actions.setHoverNode())}}(e))}};return"component"===t.type&&(e.style=Object.fromEntries(Object.keys(t.props).map((function(e){return["--c".concat(t.component,"_").concat(e),t.props[e]]})))),e}return c}),[u,s,n,t,l,c]);return r.a.createElement(kt[t.type],{node:t,path:n,classPrefix:o,attrs:d})}));function _t(e){var t=e.node,n=e.active,a=e.classPrefix,o=e.attrs;return r.a.createElement(bt.Provider,{value:n},r.a.createElement(wt,{key:"tpl-toot-".concat(t.id),node:t,path:ft,attrs:o,classPrefix:a}))}var Nt=function(e){Object(ne.a)(n,e);var t=Object(ae.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement(_t,{node:this.props.tree,active:!0,classPrefix:"t",key:"t-root"})}}]),n}(r.a.Component),Pt=n(53),St=n.n(Pt);function Mt(e,t,n,a,o){return r.a.createElement(Z.k,{icon:"add",text:t,key:a},r.a.createElement(Z.k,{icon:"add-row-top",text:"Begin",onClick:function(){return e(pt([].concat(Object(p.a)(n),[[a,0]]),0))}}),r.a.createElement(Z.k,{icon:"add-row-bottom",text:"End",onClick:function(){return e(pt([].concat(Object(p.a)(n),[[a,o.length]]),0))}}))}function At(e){var t=e.path,n=e.useSelect,a=Object(i.d)(),o=function(e){return Object(i.e)((function(t){return b(t.editor.document.template,e)}))}(t);return o?r.a.createElement(Z.j,null,n&&r.a.createElement(Z.k,{icon:"select",text:"Select it",onClick:function(){return a(st(t))}}),t.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Z.k,{icon:"double-chevron-up",text:"Add before",onClick:function(){return a(pt(t,0))}}),r.a.createElement(Z.k,{icon:"double-chevron-down",text:"Add after",onClick:function(){return a(pt(t,1))}})),"tag"===o.type&&Mt(a,"Add element",t,"children",o.slots.children),"component"===o.type&&Object.keys(o.slots).map((function(e){return Mt(a,"Add element to ".concat(e),t,e,o.slots[e])})),t.length>0&&r.a.createElement(Z.k,{icon:"delete",text:"Delete"},r.a.createElement(Z.k,{icon:"thumbs-up",text:"Yes",onClick:function(){return a(function(e){return function(t,n){Object(i.b)((function(){t(I.actions.setActiveNode()),t(R.actions.removeNode(e))}))}}(t))}}))):null}var Bt={shadow:"new-object",component:"box",tag:"double-chevron-left"};function Ft(e){return"tag"===e.type?"<".concat(e.tag," />"):"component"===e.type?e.component:e.type}function It(e){var t=e.item,n=e.path,a=Object(i.d)();return r.a.createElement(Z.n,{content:r.a.createElement(At,{path:n,useSelect:!0}),interactionKind:Z.o.CLICK},r.a.createElement("span",{onMouseOver:function(){return a(mt(n))}},r.a.createElement(Z.a,Object.assign({},t,{className:St.a.breadCrumb}))))}var Rt=function(e){var t=e.path,n=Object(it.a)(e,["path"]);return r.a.createElement(It,{item:n,path:t})},Dt=[],Lt=function(e){var t=e.editor;return[t.document.template,t.vars.activeNodePath||Dt]};function Tt(){var e=Object(i.e)(Lt,P),t=Object(C.a)(e,2),n=t[0],a=t[1],o=function(e,t){for(var n=[e],a=0;a<t.length;++a){var r=t[a];e=e.slots[r[0]][r[1]],n.push(e)}return n}(n,a).map((function(e,t){var n=a.slice(0,t);return{text:Ft(e),icon:Bt[e.type],path:n}}));return r.a.createElement("div",{className:St.a.bottom},r.a.createElement(Z.b,{items:o,breadcrumbRenderer:Rt,currentBreadcrumbRenderer:Rt}))}var Ht=n(54),Wt=n.n(Ht);function Kt(e){var t=e.uid,n=e.className,a=Object(i.e)(z),o=Object(i.e)(W),c=a.get(t);if(c){var u=B(c.getBoundingClientRect());return r.a.createElement("div",{className:n,style:{left:u.left+o.left-1,top:u.top+o.top-1,width:u.width,height:u.height}})}return null}function Ut(e){var t=e.selectedUid;return Object(i.e)(K,P).filter((function(e){return e.uid!==t})).map((function(e){return r.a.createElement(Kt,{uid:e.uid,className:Wt.a.blinkBox,key:e.uid})}))}var zt=r.a.memo((function(){var e=Object(i.e)(T,N);return"shadow"!==(null===e||void 0===e?void 0:e.node.type)&&r.a.createElement(r.a.Fragment,null,e&&r.a.createElement(Kt,{uid:e.node.id,className:Wt.a.selectedBox}),r.a.createElement(Ut,{selectedUid:null===e||void 0===e?void 0:e.node.id}))}));function Vt(){var e=Object(i.f)(),t=Object(i.e)(U);return Object(a.useEffect)((function(){t&&Promise.resolve().then((function(){var n=t.left,a=t.top,o=t.path;Z.f.show(r.a.createElement(i.a,{store:e},r.a.createElement(At,{path:o})),{left:n,top:a},(function(){e.dispatch(I.actions.setContextMenu())}))}))}),[t,e]),null}var Gt=n(84),Yt=n.n(Gt),Xt=function(e){Object(ne.a)(n,e);var t=Object(ae.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).node=r.a.createRef(),e.resizeObserver=new ResizeObserver((function(){e.dispatchCoords()})),e.handleLoad=function(){var t;null===(t=e.getDoc())||void 0===t||t.body.classList.add("_frame_body"),e.forceUpdate()},e.handleMouseLeave=function(){e.props.dispatch(I.actions.removeAllBlinkAreas())},e}return Object(_.a)(n,[{key:"componentDidMount",value:function(){var e,t=this.getDoc();"complete"===(null===t||void 0===t?void 0:t.readyState)?this.handleLoad():null===(e=this.node.current)||void 0===e||e.addEventListener("load",this.handleLoad);this.resizeObserver.observe(this.node.current)}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.node.current)||void 0===e||e.removeEventListener("load",this.handleLoad),this.resizeObserver.disconnect()}},{key:"dispatchCoords",value:function(){var e=this.node.current.getBoundingClientRect();this.props.dispatch(I.actions.setIframeCoords(B(e)))}},{key:"getDoc",value:function(){var e;return(null===(e=this.node.current)||void 0===e?void 0:e.contentDocument)||null}},{key:"renderFrameContents",value:function(){var e=this.getDoc();return e?[c.a.createPortal(this.props.head,e.head),c.a.createPortal(this.props.content,e.body)]:null}},{key:"render",value:function(){return r.a.createElement("iframe",{ref:this.node,title:"huitle",className:Ee()(Yt.a.frame,this.props.className),onMouseLeave:this.handleMouseLeave},this.renderFrameContents())}}]),n}(a.PureComponent),Jt=n(41),Qt=n.n(Jt);function qt(e){var t=e.item,n=e.title,a=Object(i.d)(),o=Object(i.e)(V),c=N(o,t),u=c?"Click to select":"Click to preview";return r.a.createElement(Z.p,{content:u},r.a.createElement(Z.e,{interactive:!0,elevation:c?4:0,className:Qt.a.itemCard,onClick:function(){var e;a(c?dt():(e=t,function(t,n){t(I.actions.setActiveShadowContent(e))}))}},r.a.createElement(Z.d,{className:Ee()(Qt.a.itemInner,c&&"bp3-intent-success")},n||function(e){return"tag"===e[0]?"<".concat(e[1]):e.join(":")}(t))))}var Zt=[["slot"]],$t=[["tag","div"]];function en(){var e=Object(i.e)((function(e){return e.components.components})),t=Object(i.e)((function(e){return e.editor.vars})),n="component"===t.documentId.type,o=Object(a.useMemo)((function(){return(n?e.filter((function(e){return e.id!==t.documentId.id})):e).map((function(e){return[["component",e.id],"%".concat(e.name)]}))}),[n,e,t.documentId]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Qt.a.grid},n&&Zt.map((function(e){return r.a.createElement(qt,{item:e,key:e.join(":")})})),$t.map((function(e){return r.a.createElement(qt,{item:e,key:e.join(":")})})),o.map((function(e){var t=Object(C.a)(e,2),n=t[0],a=t[1];return r.a.createElement(qt,{item:n,title:a,key:n.join(":")})}))))}var tn=function(e){var t=T(e);return["shadow"===(null===t||void 0===t?void 0:t.node.type),H(e)]};function nn(){var e=Object(i.e)(tn,P),t=Object(C.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{style:{width:a.width/3*2,height:a.height,top:a.top,left:n?a.width/3:"100%"},className:Qt.a.slidePanel},n&&r.a.createElement(en,null))}var an=function(e){var t;return[L(e),H(e),W(e),"shadow"===(null===(t=T(e))||void 0===t?void 0:t.node.type),!!V(e)]};function rn(){var e=Object(a.useRef)(),t=Object(i.d)(),n=Object(i.e)(an,P),o=Object(C.a)(n,5),c=o[0],u=o[1],l=o[2],s=o[3],d=o[4],p=Object(a.useMemo)((function(){var e=(u.width/3-l.left)/l.width;return{"--iframe-scale":e,"--iframe-translate":(e-1)/2}}),[u,l]);return Object(a.useEffect)((function(){var n=new ResizeObserver((function(){var n=e.current.getBoundingClientRect();t(I.actions.setMainCoords(B(n)))}));return n.observe(e.current),function(){return n.disconnect()}}),[t,e]),r.a.createElement("div",{className:ge.a.editor,ref:e},r.a.createElement("div",{className:ge.a.left}),r.a.createElement("div",{className:ge.a.center,style:p},r.a.createElement(Xt,{head:r.a.createElement(ct,{tree:c}),content:r.a.createElement(Nt,{tree:c}),dispatch:t,className:Ee()(ge.a.frame,s&&ge.a.frameMini)}),r.a.createElement(Tt,null)),s&&r.a.createElement("div",{style:Object(k.a)({position:"absolute",cursor:"pointer"},l),onClick:function(){t(d?dt():I.actions.setActiveNode())}}),r.a.createElement("div",{className:ge.a.right},r.a.createElement(Ze,null)),r.a.createElement(zt,null),r.a.createElement(Vt,null),r.a.createElement(nn,null))}var on=n(46),cn=n.n(on);function un(){var e=Object(i.d)(),t=Object(i.e)((function(e){return e.components.components}));return r.a.createElement("div",{className:cn.a.grid},t.map((function(t){return r.a.createElement(Z.e,{interactive:!0,className:cn.a.itemCard,key:t.id,onClick:function(){e(fe({type:"editor",document:{type:"component",id:t.id}}))}},t.name)})),r.a.createElement(Ae,{title:"New component name",onSubmit:function(t){return e(function(e){return function(){var t=Object(te.a)(ee.a.mark((function t(n){var a,r,o;return ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.length){t.next=9;break}return a=O([],"div"),r="id".concat(Math.round(1e8*Math.random())),t.next=5,le.components.add({id:r,name:e,template:a,props:[]});case 5:o=t.sent,console.log(r,a,o),n(fe({type:"editor",document:{type:"component",id:r}})),n(he());case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}},r.a.createElement(Z.e,{interactive:!0,className:cn.a.itemCard},r.a.createElement(Z.h,{icon:"plus",iconSize:50,intent:"primary"}))))}var ln=n(55),sn=n.n(ln);function dn(){var e=Object(i.d)(),t=Object(i.e)((function(e){return e.pages.pages}));return r.a.createElement("div",{className:sn.a.grid},t.map((function(t){return r.a.createElement(Z.e,{interactive:!0,className:sn.a.itemCard,key:t.id,onClick:function(){e(fe({type:"editor",document:{type:"page",id:t.id}}))}},t.name)})))}function pn(e){switch(e.activity.type){case"components":return r.a.createElement(un,null);case"pages":return r.a.createElement(dn,null);case"editor":return r.a.createElement(rn,null)}}var mn=function(){var e=Object(i.d)(),t=Object(i.e)(d);return r.a.createElement("div",{className:"bp3-dark ".concat(q.a.app)},r.a.createElement(Z.l,null,r.a.createElement(Z.l.Group,null,r.a.createElement(Z.l.Heading,null,"Mastkloot"),r.a.createElement(Z.l.Divider,null),r.a.createElement(Z.c,{active:"pages"===t.type,minimal:!0,icon:"document",text:"Pages",onClick:function(){return e(fe({type:"pages"}))}}),r.a.createElement(Z.c,{active:"components"===t.type,minimal:!0,icon:"box",text:"Components",onClick:function(){return e(fe({type:"components"}))}}),r.a.createElement(Z.l.Divider,null),"editor"===t.type&&r.a.createElement(Z.c,{minimal:!0,icon:"database",active:!0},t.document.id))),r.a.createElement(pn,{activity:t}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));J.dispatch(ve()),J.dispatch(he()),c.a.render(r.a.createElement(i.a,{store:J},r.a.createElement(mn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},34:function(e,t,n){e.exports={editor:"Editor_editor__tTmoQ",frame:"Editor_frame__30Iew",frameMini:"Editor_frameMini__2yphG",left:"Editor_left__1PAZX",center:"Editor_center__1ejEu",right:"Editor_right__3s0DM"}},41:function(e,t,n){e.exports={slidePanel:"SelectComponent_slidePanel__k6Ase",grid:"SelectComponent_grid__3S3s-",itemCard:"SelectComponent_itemCard__17QvB",itemInner:"SelectComponent_itemInner__13IYX"}},45:function(e,t,n){e.exports={cell:"Prop_cell__3WLE8"}},46:function(e,t,n){e.exports={grid:"Components_grid__3cMou",itemCard:"Components_itemCard__Pio8N"}},53:function(e,t,n){e.exports={bottom:"Bottom_bottom__kAYWa",breadCrumb:"Bottom_breadCrumb__b1Wwv"}},54:function(e,t,n){e.exports={blinkBox:"Floats_blinkBox__2surn",BlinkBoxKF:"Floats_BlinkBoxKF__2r1aL",selectedBox:"Floats_selectedBox__3Ci8h"}},55:function(e,t,n){e.exports={grid:"Pages_grid__1wjwN",itemCard:"Pages_itemCard__3Cwgl"}},75:function(e,t,n){e.exports={app:"App_app__2GKdF"}},77:function(e,t,n){e.exports={rightSpace:"RightSpace_rightSpace__1jKhQ"}},78:function(e,t,n){e.exports={propSelect:"TagProps_propSelect__2YFwd"}},79:function(e,t,n){e.exports={allProps:"PropsList_allProps__3a0GU"}},83:function(e,t,n){e.exports={menu:"length_menu__2eXfK"}},84:function(e,t,n){e.exports={frame:"Frame_frame__wkmfn"}}},[[126,1,2]]]);
//# sourceMappingURL=main.d49dda71.chunk.js.map